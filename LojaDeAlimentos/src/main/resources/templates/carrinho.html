<!DOCTYPE html>
<html>

<head>
<meta charset="UTF-8">
<title>Carrinho</title>
<link th:href="@{/css/comprar.css}" rel="stylesheet" />
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
</head>

<body>
	<div class="topbar">
	<button style="padding: 5px; border-radius: 10px; text-decoration: none">
			<a th:href="@{/compra/{id}(id=${compra.id})}" style="text-decoration: none">Continuar Comprando</a>
		</button>
		<div class="cart">
			<i id="cartIcon" class="fa fa-shopping-cart"></i> <span
				class="cart-count" th:text="${compra.qtdAlimentos}"></span>
			<!-- Modal -->
			<div id="cartModal" class="modal">
				<div class="modal-content">
					<span class="close" id="closeModal">&times;</span>	
					<h1>Detalhes da Compra</h1>
					<p>
						ID: <span th:text="${compra.id}"></span>
					</p>
					<p>
						Data e Hora: <span
							th:text="${#dates.format(compra.dataHora, 'HH:mm:ss')}"></span>
					</p>
					<p>
						Quantidade de Alimentos: <span th:text="${compra.qtdAlimentos}"></span>
					</p>
					<p>
						Pre√ßo Final: <span th:text="${compra.precoFinal}"></span>
					</p>
					<p>
						Cliente: <span th:text="${compra.cpfCliente}"></span>
					</p>

					<th:block th:if="${compra.finalizado}">
						<p>
							Compra finalizada em: <span
								th:text="${#dates.format(compra.dataHora, 'dd/MM/yyyy HH:mm:ss')}"></span>
						</p>
					</th:block>

					<th:block th:unless="${compra.finalizado}">
						<form th:action="@{/compra/{id}/finalizar(id=${compra.id})}"
							method="post">
							<button type="submit">Finalizar Compra</button>
						</form>
					</th:block>
				</div>
			</div>
		</div>
		<div class="balance">
			Saldo: R$ <span th:text="${saldoCliente}"></span>
		</div>

	</div>
		<div class="container">
			<div th:each="alimento : ${alimentos}" class="card"
				th:classappend="${alimento.tipoAlimento}">
				<div class="rectangle">
					<h2 th:text="${alimento.nome}"></h2>
					<p class="price">
						R$ <span th:text="${alimento.preco}"></span>
					</p>
				</div>
				<form th:action="@{/compra/deletarAlimento}" method="post">
					<input type="hidden" name="idCompra" th:value="${compra.id}" /> <input
						type="hidden" name="nomeAlimento" th:value="${alimento.nome}" />
					<button type="submit">Remover</button>
				</form>
			</div>
		</div>
		
</body>
<script>

const cartIcon = document.getElementById("cartIcon");
const closeModal = document.getElementById("closeModal");
const cartModal = document.getElementById("cartModal");

cartIcon.addEventListener("click", () => {
    cartModal.style.display = "block";
});

closeModal.addEventListener("click", () => {
    cartModal.style.display = "none";
});

cartModal.addEventListener("click", (event) => {
    if (event.target === cartModal) {
        cartModal.style.display = "none";
    }
});

</script>
</html>
